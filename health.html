<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Здоровье</title>
  <link rel="stylesheet" href="css/styles.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
</head>
<body>
  <header class="d-flex justify-content-between align-items-center p-3">
    <a href="index.html" class="profile-btn btn btn-light rounded-circle" aria-label="Профиль">
      <!-- SVG иконка профиля -->
      <svg width="32" height="32" xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true">
        <circle cx="16" cy="10" r="8"></circle>
        <path d="M6 28c0-6 6-9 10-9s10 3 10 9"></path>
      </svg>
    </a>
    <div class="search-container w-50">
      <input type="text" id="search" class="form-control" placeholder="Поиск..." aria-label="Поле поиска">
    </div>
    <button id="geolocation-btn" class="btn btn-primary" aria-label="Определить местоположение">
      <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
    </button>
  </header>

  <main class="container main-with-padding">
    <h1 class="text-center mt-4">Советы по здоровью</h1>
    <p class="text-center mb-4">Здесь будут индивидуальные советы по здоровью.</p>

    <!-- Блок уведомлений (alerts) -->
    <section id="alerts-section" aria-live="polite" aria-atomic="true" class="mb-4">
      <!-- Alerts будут вставлены сюда через JS или можно оставить статично как пример -->
      <div class="health-alert alert-danger card alert-card d-flex align-items-start" role="alert" data-alert-id="magnetstorm-today">
        <div class="alert-icon">
          <i class="fas fa-radiation-alt" aria-hidden="true"></i>
        </div>
        <div class="alert-body flex-grow-1">
          <h3 class="alert-title">Сегодня сильные магнитные бури</h3>
          <p class="mb-0">Рекомендация: по возможности оставайтесь дома, поменьше времени проводите на улице и избегайте интенсивных нагрузок.</p>
        </div>
        <button class="btn btn-sm btn-light ms-3 alert-close" aria-label="Закрыть уведомление">
          <i class="fas fa-times" aria-hidden="true"></i>
        </button>
      </div>

      <div class="health-alert alert-warning card alert-card d-flex align-items-start" role="alert" data-alert-id="sleep-tip">
        <div class="alert-icon">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </div>
        <div class="alert-body flex-grow-1">
          <h3 class="alert-title">Плохой сон из-за бурь?</h3>
          <p class="mb-0">Попробуйте отключить яркий экран за 1 час до сна, выпить тёплый травяной чай и проветрить комнату за 30 минут до сна.</p>
        </div>
        <button class="btn btn-sm btn-light ms-3 alert-close" aria-label="Закрыть уведомление">
          <i class="fas fa-times" aria-hidden="true"></i>
        </button>
      </div>
    </section>

    <!-- Основной контент -->
    <section>
      <!-- сюда ваш основной контент -->
      <article>
        <h2>Полезные советы</h2>
        <p>Раздел с основными рекомендациями по здоровью...</p>
      </article>
    </section>
  </main>

  <footer>
    <nav class="bottom-nav" aria-label="Основное меню">
      <a href="map.html" aria-label="Открыть карту">
        <i class="fas fa-map-marked-alt" aria-hidden="true"></i>
      </a>
      <a href="health.html" aria-label="Открыть советы по здоровью">
        <i class="fas fa-heartbeat" aria-hidden="true"></i>
      </a>
      <a href="chat.html" aria-label="Открыть чат-бота">
        <i class="fas fa-comments" aria-hidden="true"></i>
      </a>
      <a href="news.html" aria-label="Открыть новости">
        <i class="fas fa-newspaper" aria-hidden="true"></i>
      </a>
      <a href="menu.html" aria-label="Открыть меню">
        <i class="fas fa-bars" aria-hidden="true"></i>
      </a>
    </nav>
  </footer>

  <!-- Скрипты: обработка закрытия уведомлений и сохранение в localStorage до конца дня -->
  <script>
    (function () {
      const ALERT_PREFIX = 'alerts_dismissed_'; // ключ в localStorage будет с добавкой даты
      const todayKey = (new Date()).toISOString().slice(0,10); // YYYY-MM-DD
      const storageKey = ALERT_PREFIX + todayKey;

      // прочитать уже закрытые
      let dismissed = {};
      try {
        dismissed = JSON.parse(localStorage.getItem(storageKey) || '{}');
      } catch (e) {
        dismissed = {};
      }

      // скрыть те, что в dismissed
      document.querySelectorAll('.health-alert').forEach(alert => {
        const id = alert.getAttribute('data-alert-id') || alert.querySelector('.alert-title')?.innerText || null;
        if (id && dismissed[id]) {
          alert.style.display = 'none';
        }
      });

      // навесить обработчик на кнопки закрытия
      document.querySelectorAll('.alert-close').forEach(btn => {
        btn.addEventListener('click', function (e) {
          const alert = e.currentTarget.closest('.health-alert');
          if (!alert) return;
          const id = alert.getAttribute('data-alert-id') || alert.querySelector('.alert-title')?.innerText;
          // анимация скрытия
          alert.style.transition = 'opacity 0.25s ease, transform 0.25s ease';
          alert.style.opacity = 1;
          requestAnimationFrame(() => {
            alert.style.opacity = 0;
            alert.style.transform = 'translateY(-6px) scale(0.99)';
          });
          setTimeout(() => { alert.style.display = 'none'; }, 260);

          // сохранить в localStorage
          if (id) {
            try {
              dismissed[id] = true;
              localStorage.setItem(storageKey, JSON.stringify(dismissed));
            } catch (err) {
              console.warn('Не удалось сохранить dismiss в localStorage', err);
            }
          }
        });
      });

      // Дополнительно: если хотите программно добавить alert (например, в зависимости от API/погоды),
      // можно создать узел и вставить в #alerts-section
      // функция createAlert(title, text, type, id) { ... }
    })();
  </script>
</body>
</html>
